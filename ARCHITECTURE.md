# ğŸ—ï¸ Habit Tracker Architecture

## Current Architecture (localStorage)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Your Browser                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚  React App   â”‚                                          â”‚
â”‚  â”‚              â”‚                                          â”‚
â”‚  â”‚  - Daily     â”‚                                          â”‚
â”‚  â”‚  - Weekly    â”‚ â”€â”€â”€â”€â”€â”€â–º localStorage â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  - Monthly   â”‚         (Browser Only)           â”‚       â”‚
â”‚  â”‚  - Syllabus  â”‚                                  â”‚       â”‚
â”‚  â”‚  - Badges    â”‚                                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚       â”‚
â”‚                                                     â”‚       â”‚
â”‚  âŒ Data lost on browser clear                     â”‚       â”‚
â”‚  âŒ No sync across devices                         â”‚       â”‚
â”‚  âŒ No sync across browsers                        â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## New Architecture (Supabase)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Laptop        â”‚       â”‚   Your Phone         â”‚       â”‚   Friend's Device    â”‚
â”‚                      â”‚       â”‚                      â”‚       â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React App     â”‚  â”‚       â”‚  â”‚  React App     â”‚  â”‚       â”‚  â”‚  React App     â”‚  â”‚
â”‚  â”‚  (localhost)   â”‚  â”‚       â”‚  â”‚  (Vercel)      â”‚  â”‚       â”‚  â”‚  (Vercel)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚          â”‚       â”‚           â”‚          â”‚       â”‚           â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                              â”‚                              â”‚
            â”‚                              â”‚                              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTPS + WebSocket
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                     â”‚
                    â”‚  SUPABASE CLOUD     â”‚
                    â”‚                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ PostgreSQL DB â”‚  â”‚
                    â”‚  â”‚               â”‚  â”‚
                    â”‚  â”‚ - User 1 Data â”‚  â”‚
                    â”‚  â”‚ - User 2 Data â”‚  â”‚
                    â”‚  â”‚ - User 3 Data â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ Real-Time     â”‚  â”‚
                    â”‚  â”‚ Subscriptions â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ Authenticationâ”‚  â”‚
                    â”‚  â”‚ (Google)      â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Data persists in cloud
âœ… Syncs across all devices
âœ… Real-time updates
âœ… Secure authentication
âœ… Works on localhost AND production
```

## Data Flow Example

### Creating a Daily Task:

```
1. User types "Study Math" on Laptop
   â”‚
   â–¼
2. React App calls: createDailyGoal({ content: "Study Math", ... })
   â”‚
   â–¼
3. Supabase Hook sends data to Supabase
   â”‚
   â–¼
4. Supabase saves to PostgreSQL database
   â”‚
   â–¼
5. Supabase broadcasts change via WebSocket
   â”‚
   â”œâ”€â”€â–º Laptop: UI updates âœ…
   â”‚
   â”œâ”€â”€â–º Phone: UI updates automatically âœ…
   â”‚
   â””â”€â”€â–º Other tabs: UI updates automatically âœ…
```

### Marking Task as Complete:

```
1. User checks checkbox on Phone
   â”‚
   â–¼
2. React App calls: updateDailyGoal(id, { completed: true })
   â”‚
   â–¼
3. Supabase updates database
   â”‚
   â–¼
4. Real-time subscription notifies all devices
   â”‚
   â”œâ”€â”€â–º Phone: Checkbox checked âœ…
   â”‚
   â”œâ”€â”€â–º Laptop: Checkbox checked automatically âœ…
   â”‚
   â””â”€â”€â–º Other devices: Checkbox checked automatically âœ…
```

## Database Schema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPABASE DATABASE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  daily_goals                                                â”‚
â”‚  â”œâ”€â”€ id (UUID)                                              â”‚
â”‚  â”œâ”€â”€ user_id (UUID) â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”œâ”€â”€ date (DATE)           â”‚                                â”‚
â”‚  â”œâ”€â”€ content (TEXT)        â”‚                                â”‚
â”‚  â””â”€â”€ completed (BOOLEAN)   â”‚                                â”‚
â”‚                            â”‚                                â”‚
â”‚  weekly_goals              â”‚                                â”‚
â”‚  â”œâ”€â”€ id (UUID)             â”‚                                â”‚
â”‚  â”œâ”€â”€ user_id (UUID) â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”œâ”€â”€ week_start (DATE)     â”‚                                â”‚
â”‚  â””â”€â”€ title (TEXT)          â”‚                                â”‚
â”‚                            â”‚                                â”‚
â”‚  monthly_goals             â”‚                                â”‚
â”‚  â”œâ”€â”€ id (UUID)             â”‚                                â”‚
â”‚  â”œâ”€â”€ user_id (UUID) â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”œâ”€â”€ year (INTEGER)        â”‚                                â”‚
â”‚  â””â”€â”€ title (TEXT)          â”‚                                â”‚
â”‚                            â”‚                                â”‚
â”‚  subjects                  â”‚                                â”‚
â”‚  â”œâ”€â”€ id (UUID)             â”‚                                â”‚
â”‚  â”œâ”€â”€ user_id (UUID) â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”œâ”€â”€ name (TEXT)           â”‚                                â”‚
â”‚  â””â”€â”€ color (TEXT)          â”‚                                â”‚
â”‚                            â”‚                                â”‚
â”‚  chapters                  â”‚                                â”‚
â”‚  â”œâ”€â”€ id (UUID)             â”‚                                â”‚
â”‚  â”œâ”€â”€ subject_id (UUID)     â”‚                                â”‚
â”‚  â”œâ”€â”€ name (TEXT)           â”‚                                â”‚
â”‚  â””â”€â”€ completed (BOOLEAN)   â”‚                                â”‚
â”‚                            â”‚                                â”‚
â”‚  gamification_stats        â”‚                                â”‚
â”‚  â”œâ”€â”€ id (UUID)             â”‚                                â”‚
â”‚  â”œâ”€â”€ user_id (UUID) â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”œâ”€â”€ tasks_completed (INT) â”‚                                â”‚
â”‚  â”œâ”€â”€ current_streak (INT)  â”‚                                â”‚
â”‚  â””â”€â”€ total_study_hours     â”‚                                â”‚
â”‚                            â”‚                                â”‚
â”‚  badges                    â”‚                                â”‚
â”‚  â”œâ”€â”€ id (UUID)             â”‚                                â”‚
â”‚  â”œâ”€â”€ user_id (UUID) â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚  â”œâ”€â”€ badge_id (TEXT)                                        â”‚
â”‚  â”œâ”€â”€ unlocked (BOOLEAN)                                     â”‚
â”‚  â””â”€â”€ unlocked_at (TIMESTAMP)                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”’ Row Level Security (RLS):
   - Users can only see their own data
   - Automatic filtering by user_id
   - No manual security checks needed
```

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY LAYERS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Layer 1: Authentication                                    â”‚
â”‚  â”œâ”€â”€ Google Sign-In                                         â”‚
â”‚  â”œâ”€â”€ JWT Token                                              â”‚
â”‚  â””â”€â”€ Session Management                                     â”‚
â”‚                                                             â”‚
â”‚  Layer 2: Row Level Security (RLS)                          â”‚
â”‚  â”œâ”€â”€ Policy: SELECT WHERE user_id = auth.uid()              â”‚
â”‚  â”œâ”€â”€ Policy: INSERT WHERE user_id = auth.uid()              â”‚
â”‚  â”œâ”€â”€ Policy: UPDATE WHERE user_id = auth.uid()              â”‚
â”‚  â””â”€â”€ Policy: DELETE WHERE user_id = auth.uid()              â”‚
â”‚                                                             â”‚
â”‚  Layer 3: API Security                                      â”‚
â”‚  â”œâ”€â”€ HTTPS Only                                             â”‚
â”‚  â”œâ”€â”€ CORS Configuration                                     â”‚
â”‚  â””â”€â”€ Rate Limiting                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Result: Users can ONLY access their own data! ğŸ”
```

## Deployment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEVELOPMENT                               â”‚
â”‚                                                              â”‚
â”‚  1. Code on localhost:3000                                   â”‚
â”‚  2. Connect to Supabase Cloud                                â”‚
â”‚  3. Test features                                            â”‚
â”‚  4. Data saved to Supabase                                   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ git push
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GITHUB                                    â”‚
â”‚                                                              â”‚
â”‚  1. Code pushed to repository                                â”‚
â”‚  2. Vercel detects changes                                   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Auto Deploy
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VERCEL (PRODUCTION)                       â”‚
â”‚                                                              â”‚
â”‚  1. Builds Next.js app                                       â”‚
â”‚  2. Deploys to your-app.vercel.app                           â”‚
â”‚  3. Connects to SAME Supabase database                       â”‚
â”‚  4. Users access production app                              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Uses same database
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPABASE CLOUD                            â”‚
â”‚                                                              â”‚
â”‚  - Same database for localhost AND production                â”‚
â”‚  - Data created on localhost appears on production           â”‚
â”‚  - Data created on production appears on localhost           â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Differences: Before vs After

| Feature | localStorage (Before) | Supabase (After) |
|---------|----------------------|------------------|
| **Data Storage** | Browser only | Cloud database |
| **Persistence** | Lost on clear | Permanent |
| **Cross-device** | âŒ No | âœ… Yes |
| **Real-time sync** | âŒ No | âœ… Yes |
| **Multi-user** | âŒ No | âœ… Yes |
| **Authentication** | âŒ No | âœ… Yes |
| **Security** | âŒ Anyone can access | âœ… User-specific |
| **Backup** | âŒ No | âœ… Automatic |
| **Scalability** | âŒ Limited | âœ… Unlimited |
| **Production-ready** | âŒ No | âœ… Yes |

---

**This architecture ensures your app works seamlessly on localhost, production, and across all devices! ğŸš€**
